server.port=${SERVER_PORT:8080}

spring.jmx.enabled=true
management.endpoint.health.enabled=true
management.endpoint.metrics.enabled=true
management.endpoint.info.enabled=true
management.endpoint.env.enabled=true

management.endpoints.jmx.exposure.include=env,health,info,metrics
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.env.show-values=ALWAYS

spring.application.name=inventory-service

spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5434}/${DB_NAME:inventory}
spring.datasource.username=${DB_USER:inventory}
spring.datasource.password=${DB_PASS:invpw}

spring.jpa.hibernate.ddl-auto=update
spring.jpa.open-in-view=false

# 호스트(맥)에서 앱 실행 시: docker-compose의 EXTERNAL 리스너(예: localhost:29092)에 붙기
spring.kafka.bootstrap-servers=${KAFKA_BOOTSTRAP_SERVERS:localhost:29092}

spring.kafka.consumer.group-id=inventory-service
spring.kafka.consumer.key-deserializer=org.apache.kafka.common.serialization.StringDeserializer
spring.kafka.consumer.value-deserializer=org.springframework.kafka.support.serializer.JsonDeserializer
spring.kafka.consumer.properties.spring.json.trusted.packages=com.workshop.inventory.events
spring.kafka.consumer.properties.spring.json.value.default.type=com.workshop.inventory.events.OrderCreatedEvent
spring.kafka.consumer.properties.spring.json.use.type.headers=false
spring.kafka.consumer.properties.spring.json.fail-on-unknown-properties=false

spring.kafka.producer.key-serializer=org.apache.kafka.common.serialization.StringSerializer
spring.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer
spring.kafka.producer.properties.spring.json.add.type.headers=false

# 이벤트 네임스페이스(토픽 접두사)
app.event.ns=${EVENT_NS:orders.v1}
app.order.created-topic=${EVENT_NS:orders.v1}.created
